<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Contact Us - TopScore Method</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="contact-page">
    <div class="contact-container">
        <h2>Contact TopScore Method</h2>
        <p>Have questions about our programs or services? Get in touch below!</p>
        
        <form name="submit-to-google-sheet">
            <input type="text" name="Name" placeholder="Your Name" required>
            <input type="email" name="Email" placeholder="Your Email" required>
            <textarea name="Subject" rows="1" placeholder="Subject" required></textarea>
            <textarea name="message" rows="6" placeholder="Your Message" required></textarea>
            <button type="submit" class="btn btn2">Submit</button>
        </form>

        <span id="msg"></span>

        <!-- Back Button -->
        <a href="index.html" class="btn back-btn">‚Üê Back to Home</a>
    </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxkF_e9MorkNX2uKMCQW8q8UdYmRJUMwdYl1q-djvxTMtD45odSpqOEZQ3EcZdUf6ZO4g/exec';
            const form = document.forms['submit-to-google-sheet'];
            const msg = document.getElementById("msg");
            const submitButton = form.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;

            form.addEventListener('submit', e => {
                e.preventDefault();

                submitButton.disabled = true;
                submitButton.textContent = "Sending...";

                fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                    .then(response => {
                        msg.textContent = "Thank you! Your message has been sent.";
                        setTimeout(() => msg.textContent = "", 5000);
                        form.reset();
                    })
                    .catch(error => {
                        msg.textContent = "Oops! Something went wrong. Please try again.";
                        console.error('Error!', error.message);
                    })
                    .finally(() => {
                        setTimeout(() => {
                            submitButton.disabled = false;
                            submitButton.textContent = originalText;
                        }, 5000);
                    });
            });
        });
    </script>
</body>
</html>
